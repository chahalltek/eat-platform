# MVP Batches 1â€“3 Traceability Matrix

These entries map the MVP batch tickets to the concrete code and checks that prove they exist today. Use `npm run verify:mvp` for the fast audit harness covering the highlighted subsystems (JobIntent helpers, agent run logging, diagnostics builder, and API smoke routes).

| Ticket | Feature statement | Code pointers | How to verify | Status |
| --- | --- | --- | --- | --- |
| B1-INTAKE | INTAKE agent parses job descriptions, normalizes fields, and persists `jobReq`/`jobSkill` updates. | `runIntake` normalizes LLM output and writes job + skills while recording metrics.ã€F:src/server/agents/intake.tsâ€ L36-L125ã€‘ | Run the INTAKE API test (`vitest run tests/agents/intake-api.test.ts`) or submit `POST /api/agents/intake` against a seeded job and confirm updated job + skills. | âœ… |
| B1-JOB-INGEST | Authenticated job ingestion builds an intent payload and upserts `jobIntent`. | Ingestion route validates admin calls, constructs payload via `buildJobIntentPayload`, and persists intent with the job.ã€F:src/app/api/jobs/ingest/route.tsâ€ L31-L109ã€‘ | Execute `npm run verify:mvp` to exercise the JobIntent helpers, or call `POST /api/jobs/ingest` with title + skills and inspect created `jobIntent` row. | âœ… |
| B1-RESUME-UPLOAD | Resume upload plumbing extracts text, sanitizes it, and stores the blob for PROFILE parsing. | Upload handler enforces file rules, extracts text, and returns normalized metadata.ã€F:src/app/api/upload/resume/route.tsâ€ L26-L95ã€‘ | Submit a PDF/DOCX to `POST /api/upload/resume` and confirm JSON includes sanitized text + `blobPath` while rejecting oversized files. | âœ… |
| B1-INTENT-SNAPSHOT | Hiring manager brief/feedback routes read persisted `jobIntent` snapshots. | HM brief route loads `jobIntent` for the job and returns intent-derived context.ã€F:src/app/api/jobs/[jobId]/hm-brief/route.tsâ€ L47-L76ã€‘ | Seed a job with `jobIntent`, call `GET /api/jobs/{jobId}/hm-brief`, and confirm the intent snapshot appears; add upstream ingestion if empty. | ğŸŸ¡ |
| B2-PROFILE | PROFILE agent parses resumes into candidate + skill records with deterministic logging. | Profile route delegates to RINA helper and writes candidate/candidateSkill rows with agent run log.ã€F:src/app/api/agents/profile/route.tsâ€ L21-L99ã€‘ | Run `vitest run tests/agents/profile-api.test.ts` or post to `POST /api/agents/profile` with `rawResumeText` and verify candidate + skills exist. | âœ… |
| B2-MATCH-CONFIDENCE | MATCH agent scores candidates deterministically and embeds confidence breakdowns. | Matcher loads job/candidate data, applies job intent, scores, and writes match records with confidence helpers.ã€F:src/lib/agents/matcher.tsâ€ L40-L163ã€‘ã€F:src/lib/agents/confidenceEngine.tsâ€ L16-L86ã€‘ | Run `vitest run src/lib/agents/matcher.test.ts src/lib/agents/confidenceEngine.spec.ts` or trigger `POST /api/agents/match` with seeded job/candidates to see persisted match results. | âœ… |
| B2-EXPLAIN/SHORTLIST | EXPLAIN agent returns rationale for matches; SHORTLIST persists recruiter decisions. | Explain engine generates reasoned explanations; shortlist route updates matchResult flags for recruiter actions.ã€F:src/lib/agents/explainEngine.tsâ€ L22-L130ã€‘ã€F:src/app/api/agents/shortlist/route.tsâ€ L22-L76ã€‘ | Run `vitest run tests/agents/explainEngine.test.ts tests/agents/shortlist-api.test.ts` or exercise `/api/agents/explain` then `/api/agents/shortlist` for an existing match. | âœ… |
| B3-DIAGNOSTICS | Tenant diagnostics surface plan/feature/guardrail readiness for admins. | Diagnostics builder aggregates ATS status, feature flags, guardrails, and retention; API route exposes it to admins; admin UI renders the table with health badges.ã€F:src/lib/tenant/diagnostics.tsâ€ L268-L507ã€‘ã€F:src/app/api/tenant/diagnostics/route.tsâ€ L1-L33ã€‘ã€F:src/app/admin/tenant/[tenantId]/diagnostics/page.tsxâ€ L157-L305ã€‘ | `npm run verify:mvp` runs the diagnostics unit + smoke tests, or call `GET /api/tenant/diagnostics` as a tenant admin to confirm readiness payload renders in the admin diagnostics page. | âœ… |
| B3-OPS-RUNBOOK | Operations runbook surfaces diagnostics, feature flags, and guardrails for tenant admins. | Admin operations runbook page links diagnostics and guardrail status for the tenant.ã€F:src/app/admin/tenant/[tenantId]/operations-runbook/page.tsxâ€ L243-L305ã€‘ | Manually load `/admin/tenant/{tenantId}/operations-runbook` and verify the diagnostics + guardrails callouts render for the tenant. | ğŸŸ¡ |
